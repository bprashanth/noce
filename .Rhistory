auto <- read.csv("/home/beeps/rtmp/external/eco/noce/islr/labs/3/data/auto.csv") 
auto = na.omit(auto)
auto[33,]
?unique_non_numerics
tauto=auto[33,]
tauto[0]
tauto[1]
tauto
as.numeric(tauto)
as.numeric(subset(tauto, -name))
as.numeric(subset(tauto, select=-name))
which(is.na(as.numeric(subset(tauto, select=-name))))
tauto[4]
data.frame(sapply(subset(auto, select=-name), function(x) as.numeric(x)))
tauto<-data.frame(sapply(subset(auto, select=-name), function(x) as.numeric(x)))
tauto[33,]
is.na(tauto)
which(is.na(tauto))
1224/8
33*8
which(is.na(tauto))
1224/9
na.omit(tauto)
na.omit(tauto)[33,]
auto_clean <- na.omit(subset(data.frame(sapply(auto, function(x) as.numeric(x))), select=-name))
lm.ols=lm(mpg~., data=auto_clean)
summary(lm.ols)
par(mfrow(2,2))
par(mfrow(c(2,2)))
par(mfrow=c(2,2))
plot(lm.ols)
plot(predict(lm.ols), rstudent(lm.fit))

plot(predict(lm.ols), rstudent(lm.fit))

?rstudent
plot(predict(lm.ols), rstudent(lm.ols))

plot(hatvalues(lm.ols))
which(hatvalues(lm.ols)
)
which.max(hatvalues(lm.ols))
auto[14,]
lm.ols[14]
lm.ols[14,]
predict(lm.ols, auto[14,])
auto[14,]
predict(lm.ols, subset(auto[14,], select=-name))
predict(lm.ols, subset(as.numeric(auto[14,]), select=-name))
as.numeric(subset(auto[14,], select=-name))
predict(lm.ols, as.numeric(subset(auto[14,], select=-name)))
auto[14,]
auto[15,]
auto[11,]
cooks.distance(lm.ols)
plot(cooks.distance(lm.ols))
plot(cooks.distance(lm.ols))
abline(h = 4*mean(cooksd, na.rm=T), col="red") 
plot(cooks.distance(lm.ols))
abline(h = 4*mean(cooksd, na.rm=T), col="red") 
par(mfrow=c(2,2))
plot(lm.ols)
plot(cooksd, pch="*", cex=2, main="Influential Obs by Cooks distance")  # plot cook's distance

plot(cooksd, pch="*", cex=2, main="Influential Obs by Cooks distance")  
cooksd <- cooks.distance(lm.ols)
plot(cooksd, pch="*", cex=2, main="Influential Obs by Cooks distance")  
abline(h = 4*mean(cooksd, na.rm=T), col="red") 
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=T),names(cooksd),""), col="red")  
plot(cooksd, pch="*", cex=2, main="Influential Obs by Cooks distance")  
text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=T),names(cooksd),""), col="red")  
head(auto)
lm.hp_wt<-lm(mpg ~ horsepower*weight, data = auto)
summary(lm.hp_wt)
lm.hp_wt <- lm(mpg~hosepower + weight + horsepower:weight, data=auto)

lm.hp_wt <- lm(mpg~horsepower + weight + horsepower:weight, data=auto)

summary(lm.hp_wt)
head(auto)
summary(lm(mpg~cylinders*horsepower, data=auto)
)
summary(lm(mpg~cylinders*weight, data=auto))
head(auto)
summary(lm(mpg~cylinders*horsepower, data=auto_clean))
summary(lm(mpg~weight*horsepower, data=auto_clean))
summary(lm(mpg~weight*cylinders, data=auto_clean))
summary(lm(mpg~weight, data=auto_clean))
summary(lm(mpg~., data=auto_clean))
summary(lm(mpg~acceleration*horsepower, data=auto_clean))
cor(auto_clean)
summary(lm(mpg~acceleration*cylinders+displacement*weight, data=auto_clean))
summary(lm(mpg~displacement*cylinders+displacement*weight, data=auto_clean))
